# Обработчик Аннотируемых Метаграфов

## Описание

Это консольное приложение для обработки аннотируемых метаграфов с агент-функциями. Программа решает следующие задачи:

1. Чтение метаграфа и агент-функции из входного файла заданного формата
2. Вычисление атрибутов всех элементов (узлов и рёбер) метаграфа согласно правилам агент-функции
3. Запись результатов в выходной файл
4. Опционально: визуализация метаграфа с отображением правил и вычисленных значений

### Что такое аннотируемый метаграф?

Аннотируемый метаграф — ориентированный граф, каждый элемент которого (узел или ребро) описывается набором атрибутов.

### Что такое агент-функция?

Агент-функция — набор правил преобразования графа и его элементов. Для каждого узла и ребра задаётся правило вычисления атрибута, которое может быть:

1. Числовое значение (прямое присваивание)
2. Ссылка на значение другого элемента (`v N` или `e N`)
3. Функция:
   - `min` (для узлов) — минимальное значение атрибутов всех входящих рёбер
   - `*` (для рёбер) — произведение значения атрибута левого узла и всех входящих в него рёбер

## Состав проекта

Проект имеет модульную структуру:

- `main.py` — точка входа в приложение
- `cli.py` — обработка аргументов командной строки
- `parser.py` — парсинг входного файла
- `evaluator.py` — вычисление атрибутов метаграфа
- `visualizer.py` — визуализация метаграфа
- `test_parser.py`, `test_evaluator.py` — unit-тесты для основных модулей

## Требования

- Python 3.6+
- NetworkX (для визуализации)
- Matplotlib (для визуализации)
- Pytest (для запуска тестов)

## Установка

```bash
# Установка зависимостей
pip install -r requirements.txt
```

## Использование

### Базовое использование

```bash
python main.py input.txt output.txt
```
`input.txt` : это существующий входной файл

`output.txt`: это выходной файл, который будет сгенерирован с вычисленными выходными данными

### С визуализацией

```bash
python main.py input.txt output.txt --visual
```

### С выбором уровня логирования

```bash
python main.py input.txt output.txt --log DEBUG
```

## Формат входного файла

1. Первая строка: два числа — количество узлов (NV) и рёбер (NE)
2. Пустая строка (опционально)
3. NE строк с парами чисел — начало и конец каждого ребра
4. Пустая строка (опционально)
5. NV строк с правилами для узлов
6. NE строк с правилами для рёбер

### Пример входного файла

```
8 8  # NV NE

1 2  # список рёбер
2 4
3 4
4 5
6 5
5 7
7 6
7 8

0.1  # список правил для узлов
2
0.2
min
min
0.5
0.3
e 8

v 1  # список правил для рёбер
*
v 3
v 4
*
v 5
v 7
v 7
```

## Формат выходного файла

Список значений атрибутов элементов графа:
1. Сначала NV строк со значениями для узлов
2. Затем NE строк со значениями для рёбер

### Пример выходного файла

```
0.1
2
0.2
0.2
0.15
0.5
0.3
0.3
0.1
0.2
0.2
0.2
0.15
0.15
0.3
0.3
```

## Запуск тестов

```bash
pytest
```

## Автор

Бахрами Амир
